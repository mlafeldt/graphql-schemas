interface Account {
  id: ID!
  slug: String!
  name: String!
  createdAt: DateTime!
  projects(after: String, before: String, first: Int, last: Int): ProjectConnection!
}

type Branch {
  id: ID!
  name: String!
  domains: [String!]!
  latestDeployment: Deployment
  activeDeployment: Deployment
  deployments(after: String, before: String, first: Int, last: Int): DeploymentConnection!
  project: Project!
}

type BranchConnection {
  """Information to aid in pagination."""
  pageInfo: PageInfo!

  """A list of edges."""
  edges: [BranchEdge]
}

"""An edge in a connection."""
type BranchEdge {
  """The item at the end of the edge"""
  node: Branch!

  """A cursor for use in pagination"""
  cursor: String!
}

type BranchMetrics {
  latency: Distribution!
  request: Distribution!
}

"""RFC3339 formatted date in the UTC time zone denoted by letter 'Z'"""
scalar DateTime

"""Deployment"""
type Deployment {
  id: ID!
  commit: GitCommit!
  branch: String!
  createdAt: DateTime!
  status: DeploymentStatus!
  logEntries: [DeploymentLogEntry!]!
  project: Project!
}

type DeploymentConnection {
  """Information to aid in pagination."""
  pageInfo: PageInfo!

  """A list of edges."""
  edges: [DeploymentEdge]
}

"""An edge in a connection."""
type DeploymentEdge {
  """The item at the end of the edge"""
  node: Deployment!

  """A cursor for use in pagination"""
  cursor: String!
}

type DeploymentLogEntry {
  createdAt: DateTime!
  message: String!
}

enum DeploymentStatus {
  PENDING
  IN_PROGRESS
  ACTIVE
  INACTIVE
  FAILED
}

type Distribution {
  unit: UnitType!
  values: [DistributionValue!]!
}

type DistributionValue {
  bucket: DateTime!
  value: Int!
}

type GitAccount {
  provider: GitProvider!
  id: ID!
  slug: String!

  """Date when the app was authorized to access this account"""
  connectedAt: DateTime!
}

type GitCommit {
  sha: String!
  message: String!
  author: String
  authorAvatarUrl: String
  committer: String
  committerAvatarUrl: String
}

enum GitProvider {
  GITHUB
}

type GitRepository {
  provider: GitProvider!
  id: String!
  owner: String!
  slug: String!
  url: String!
  defaultBranch: String
  private: Boolean!
  updatedAt: DateTime!
  schemaContents: String
  branches: [String!]!
}

type Invite {
  id: ID!
  role: MemberRole!
  email: String!
  invitedBy: User!
  lastRenewedAt: DateTime!
  status: InviteStatus!
  createdAt: DateTime!
  organization: Organization!
}

input InviteAcceptInput {
  id: ID!
}

type InviteAcceptPayload {
  member: Member!
  query: Query!
}

input InviteCancelInput {
  id: ID!
}

type InviteCancelPayload {
  id: ID!
  query: Query!
}

type InviteConnection {
  """Information to aid in pagination."""
  pageInfo: PageInfo!

  """A list of edges."""
  edges: [InviteEdge]
}

input InviteDeclineInput {
  id: ID!
}

type InviteDeclinePayload {
  id: ID!
  query: Query!
}

"""An edge in a connection."""
type InviteEdge {
  """The item at the end of the edge"""
  node: Invite!

  """A cursor for use in pagination"""
  cursor: String!
}

input InviteSendInput {
  organizationId: ID!
  email: String!
  role: MemberRole!
}

type InviteSendPayload {
  invite: Invite!
  query: Query!
}

enum InviteStatus {
  PENDING
  EXPIRED
}

input LoginInput {
  inviteId: ID
}

type LoginPayload {
  user: User!
  isFirstLogin: Boolean!
  query: Query!
}

type Member {
  id: ID!
  role: MemberRole!
  createdAt: DateTime!
  account: Account!
  user: User!
}

type MemberConnection {
  """Information to aid in pagination."""
  pageInfo: PageInfo!

  """A list of edges."""
  edges: [MemberEdge]
}

input MemberDeleteInput {
  id: ID!
}

type MemberDeletePayload {
  deletedMemberId: ID!
  query: Query!
}

"""An edge in a connection."""
type MemberEdge {
  """The item at the end of the edge"""
  node: Member!

  """A cursor for use in pagination"""
  cursor: String!
}

enum MemberRole {
  OWNER
  MEMBER
}

input MemberUpdateInput {
  id: ID!
  role: MemberRole
}

type MemberUpdatePayload {
  member: Member!
  query: Query!
}

type Mutation {
  """
  Create new organization account owned by the current user. Slug must be unique.
  """
  organizationCreate(input: OrganizationCreateInput!): OrganizationCreatePayload!
  personalAccountDelete: PersonalAccountDeletePayload!
  organizationDelete(input: OrganizationDeleteInput!): OrganizationDeletePayload!
  inviteSend(input: InviteSendInput!): InviteSendPayload!
  inviteCancel(input: InviteCancelInput!): InviteCancelPayload!
  inviteAccept(input: InviteAcceptInput!): InviteAcceptPayload!
  inviteDecline(input: InviteDeclineInput!): InviteDeclinePayload!

  """Update role of an organization member"""
  memberUpdate(input: MemberUpdateInput!): MemberUpdatePayload!

  """Remove member from an organization"""
  memberDelete(input: MemberDeleteInput!): MemberDeletePayload!

  """
  Deprecated, please use projectCreateFromRepository.
  Create new project owned by the current user. Slug must be unique for given account.
  """
  projectCreateFromRepo(input: ProjectCreateFromRepoInput!): ProjectCreateFromRepoPayload!

  """
  Create new project owned by the current user. Slug must be unique for given account.
  """
  projectCreateFromRepository(input: ProjectCreateFromRepositoryInput!): ProjectCreateFromRepositoryPayload!
  projectUpdate(input: ProjectUpdateInput!): ProjectUpdatePayload!
  projectDelete(input: ProjectDeleteInput!): ProjectDeletePayload!
  login(input: LoginInput): LoginPayload!
}

type NameSizeCheckError {
  maxLength: Int!
  message: String!
}

type Organization implements Account {
  id: ID!
  slug: String!
  name: String!
  createdAt: DateTime!
  projects(after: String, before: String, first: Int, last: Int): ProjectConnection!
  invites(after: String, before: String, first: Int, last: Int): InviteConnection!
  members(after: String, before: String, first: Int, last: Int): MemberConnection!
}

type OrganizationConnection {
  """Information to aid in pagination."""
  pageInfo: PageInfo!

  """A list of edges."""
  edges: [OrganizationEdge]
}

input OrganizationCreateInput {
  slug: String!
  name: String!
}

union OrganizationCreatePayload = OrganizationCreateSuccess | SlugError | SlugSizeCheckError | NameSizeCheckError | ReservedSlugsCheckError

type OrganizationCreateSuccess {
  organization: Organization!
  member: Member!
  query: Query!
}

input OrganizationDeleteInput {
  id: ID!
}

type OrganizationDeletePayload {
  deletedId: ID!
  query: Query!
}

"""An edge in a connection."""
type OrganizationEdge {
  """The item at the end of the edge"""
  node: Organization!

  """A cursor for use in pagination"""
  cursor: String!
}

"""Information about pagination in a connection"""
type PageInfo {
  """When paginating backwards, are there more items?"""
  hasPreviousPage: Boolean!

  """When paginating forwards, are there more items?"""
  hasNextPage: Boolean!

  """When paginating backwards, the cursor to continue."""
  startCursor: String

  """When paginating forwards, the cursor to continue."""
  endCursor: String
}

type PersonalAccount implements Account {
  id: ID!
  slug: String!
  name: String!
  createdAt: DateTime!
  projects(after: String, before: String, first: Int, last: Int): ProjectConnection!
}

type PersonalAccountDeletePayload {
  deletedId: ID!
}

type Project {
  id: ID!
  slug: String!
  createdAt: DateTime!
  repository: GitRepository!
  branches(after: String, before: String, first: Int, last: Int): BranchConnection!
  productionBranch: Branch!
}

type ProjectConnection {
  """Information to aid in pagination."""
  pageInfo: PageInfo!

  """A list of edges."""
  edges: [ProjectEdge]
}

input ProjectCreateFromRepoInput {
  accountId: ID!
  projectSlug: String!
  gitRepoUrl: Url!
  gitAccountId: String!
  productionBranch: String!
}

type ProjectCreateFromRepoPayload {
  project: Project!
  query: Query!
}

input ProjectCreateFromRepositoryInput {
  accountId: ID!
  projectSlug: String!
  gitRepoUrl: Url!
  gitAccountId: String!
  productionBranch: String!
}

union ProjectCreateFromRepositoryPayload = ProjectCreateFromRepositorySuccess | SlugAlreadyExistsError | RepositoryContainsNoBranchesError

type ProjectCreateFromRepositorySuccess {
  project: Project!
  query: Query!
}

input ProjectDeleteInput {
  id: ID!
}

type ProjectDeletePayload {
  query: Query!
}

"""An edge in a connection."""
type ProjectEdge {
  """The item at the end of the edge"""
  node: Project!

  """A cursor for use in pagination"""
  cursor: String!
}

input ProjectUpdateInput {
  id: ID!
  projectSlug: String
  productionBranch: String
}

type ProjectUpdatePayload {
  project: Project!
  query: Query!
}

type Query {
  accountBySlug(
    """slug of the account"""
    slug: String!
  ): Account
  metricsByBranch(accountSlug: String!, projectSlug: String!, branch: String!, startDate: DateTime!, endDate: DateTime!): BranchMetrics!

  """Get branch by account slug, project slug and the name of the branch."""
  branch(
    """slug of the account"""
    accountSlug: String!

    """slug of the project"""
    projectSlug: String!

    """name of the branch"""
    name: String!
  ): Branch

  """Get deployment by ID."""
  deployment(
    """ID of the deployment"""
    id: ID!
  ): Deployment

  """
  Return a list of git accounts accessible by the current user sorted by the creation date.
  """
  gitAccounts(provider: GitProvider!): [GitAccount!]!

  """
  Return a list of git repositories accessible by the current user, sorted by updatedAt.
  With `query` specified, the list will include up to 10 repos matching the query.
  Without `query`, the list will include the 10 most recently updated repos.
  """
  gitRepos(provider: GitProvider!, gitAccountId: String!, query: String): [GitRepository!]!

  """Returns details about a specific git repository identified by its URL."""
  gitRepoByUrl(url: Url!): GitRepository!

  """
  Returns the contents of the `schema.graphql` file located in a particular branch of a repository idenitifed by its URL.
  """
  schema(url: Url!, branch: String!): String
  invite(id: ID!): Invite

  """Get project by account slug and slug of the project itself."""
  projectByAccountSlug(
    """slug of the account"""
    accountSlug: String!

    """slug of the project"""
    projectSlug: String!
  ): Project

  """Give the actual connected user."""
  viewer: User
}

type RepositoryContainsNoBranchesError {
  query: Query!
}

type ReservedSlugsCheckError {
  message: String!
}

type SlugAlreadyExistsError {
  query: Query!
}

type SlugError {
  message: String!
  actual: String!
  expected: String!
}

type SlugSizeCheckError {
  maxLength: Int!
  message: String!
}

enum UnitType {
  NO_UNIT
  MILLI_SECONDS
}

"""
URL is a String implementing the [URL Standard](http://url.spec.whatwg.org/)
"""
scalar Url

type User {
  id: ID!
  name: String!
  email: String!
  avatarUrl: String
  createdAt: DateTime!
  organizations(after: String, before: String, first: Int, last: Int): OrganizationConnection!
  organizationMemberships: [Member!]!
  personalAccount: PersonalAccount!
}

